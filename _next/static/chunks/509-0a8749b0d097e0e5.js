"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[509],{9379:function(e,t,n){n.d(t,{If:function(){return c},X3:function(){return s},YD:function(){return m},YO:function(){return d},ZT:function(){return r},_I:function(){return o},eH:function(){return h},th:function(){return u},uF:function(){return p},z2:function(){return g}});let r={correctAnswer:10,perfectPronunciation:15,firstTry:5,streak3:20,streak5:50,streak10:100,lessonComplete:30,dailyGoal:100,perfectLesson:50,gameWin:50,gameHighScore:100,levelUp:200},i={baseXp:100,xpMultiplier:1.5,maxLevel:50};function a(e){if(e<=1)return 0;let{baseXp:t,xpMultiplier:n}=i;return Math.floor(t*Math.pow(n,e-2))}function s(e){let t=1,n=e;for(;t<i.maxLevel;){let e=a(t+1);if(n<e)break;n-=e,t++}return{level:t,currentXp:n,nextLevelXp:a(t+1)}}let o={correct:["잘했어요! \uD83C\uDF89","정답이에요! ⭐","훌륭해요! \uD83D\uDC4F","멋져요! \uD83C\uDF1F","완벽해요! ✨","대단해요! \uD83C\uDFC6","최고예요! \uD83D\uDC4D"],incorrect:["괜찮아요, 다시 해봐요! \uD83D\uDCAA","조금만 더 노력해봐요! \uD83C\uDF08","포기하지 마세요! ⭐","한 번 더 도전해봐요! \uD83C\uDFAF","실수해도 괜찮아요! \uD83D\uDE0A"],streak:["연속 정답! 대단해요! \uD83D\uDD25","달리고 있어요! \uD83D\uDE80","멈출 수 없어요! ⚡"],levelUp:["레벨업! 축하해요! \uD83C\uDF8A","새로운 레벨 달성! \uD83C\uDFC5","계속 성장하고 있어요! \uD83D\uDCC8"],achievement:["업적 달성! \uD83C\uDFC6","새로운 배지를 얻었어요! \uD83C\uDF96️"]},u={wordMatch:{rounds:5,timeLimit:60,pointsPerMatch:10,bonusTimePoints:5},soundQuiz:{rounds:10,optionCount:4,pointsPerCorrect:10,timeBonusThreshold:3,timeBonus:5},spelling:{rounds:8,hintsAllowed:3,pointsPerCorrect:15,pointsWithHint:10},memory:{pairCount:6,timeLimit:120,pointsPerPair:10,perfectBonus:50}},l={beginner:[{type:"alphabet",title:"알파벳 학습",description:"알파벳 5개를 배워보세요",emoji:"\uD83D\uDD24",targetCount:5,xpReward:30,order:1},{type:"phonics",title:"파닉스 기초",description:"파닉스 규칙 3개를 배워보세요",emoji:"\uD83C\uDFB5",targetCount:3,xpReward:40,order:2},{type:"words",title:"단어 배우기",description:"새로운 단어 5개를 배워보세요",emoji:"\uD83D\uDCDA",targetCount:5,xpReward:35,order:3},{type:"speaking",title:"말하기 연습",description:"단어 3개를 따라 말해보세요",emoji:"\uD83C\uDFA4",targetCount:3,xpReward:40,order:4},{type:"wordMatch",title:"단어 매칭",description:"매칭 게임을 완료하세요",emoji:"\uD83C\uDFAF",targetCount:1,xpReward:50,order:5},{type:"memory",title:"메모리 게임",description:"메모리 게임을 완료하세요",emoji:"\uD83E\uDDE0",targetCount:1,xpReward:50,order:6},{type:"spelling",title:"철자 맞추기",description:"철자 게임에서 3문제를 맞추세요",emoji:"✏️",targetCount:3,xpReward:45,order:7},{type:"soundQuiz",title:"소리 퀴즈",description:"소리 퀴즈에서 3문제를 맞추세요",emoji:"\uD83D\uDD0A",targetCount:3,xpReward:45,order:8}],intermediate:[{type:"alphabet",title:"알파벳 복습",description:"알파벳 10개를 복습하세요",emoji:"\uD83D\uDD24",targetCount:10,xpReward:40,order:1},{type:"phonics",title:"파닉스 학습",description:"파닉스 규칙 5개를 배워보세요",emoji:"\uD83C\uDFB5",targetCount:5,xpReward:50,order:2},{type:"words",title:"단어 마스터",description:"새로운 단어 8개를 배워보세요",emoji:"\uD83D\uDCDA",targetCount:8,xpReward:45,order:3},{type:"speaking",title:"발음 연습",description:"단어 5개를 따라 말해보세요",emoji:"\uD83C\uDFA4",targetCount:5,xpReward:50,order:4},{type:"wordMatch",title:"단어 매칭 챌린지",description:"매칭 게임에서 80점 이상 획득",emoji:"\uD83C\uDFAF",targetCount:80,xpReward:60,order:5},{type:"memory",title:"기억력 챌린지",description:"메모리 게임에서 100점 이상 획득",emoji:"\uD83E\uDDE0",targetCount:100,xpReward:60,order:6},{type:"spelling",title:"철자 챌린지",description:"철자 게임에서 5문제를 맞추세요",emoji:"✏️",targetCount:5,xpReward:55,order:7},{type:"soundQuiz",title:"청취력 테스트",description:"소리 퀴즈에서 5문제를 맞추세요",emoji:"\uD83D\uDD0A",targetCount:5,xpReward:55,order:8}],advanced:[{type:"alphabet",title:"알파벳 완전 정복",description:"모든 알파벳을 완벽하게 복습",emoji:"\uD83D\uDD24",targetCount:26,xpReward:60,order:1},{type:"phonics",title:"고급 파닉스",description:"파닉스 규칙 8개를 마스터하세요",emoji:"\uD83C\uDFB5",targetCount:8,xpReward:70,order:2},{type:"words",title:"단어 정복자",description:"새로운 단어 12개를 배워보세요",emoji:"\uD83D\uDCDA",targetCount:12,xpReward:65,order:3},{type:"speaking",title:"발음 마스터",description:"단어 8개를 완벽하게 발음하세요",emoji:"\uD83C\uDFA4",targetCount:8,xpReward:70,order:4},{type:"wordMatch",title:"매칭 마스터",description:"매칭 게임에서 만점 획득",emoji:"\uD83C\uDFAF",targetCount:100,xpReward:80,order:5},{type:"memory",title:"기억력 마스터",description:"메모리 게임에서 150점 이상 획득",emoji:"\uD83E\uDDE0",targetCount:150,xpReward:80,order:6},{type:"spelling",title:"철자 마스터",description:"철자 게임에서 8문제를 맞추세요",emoji:"✏️",targetCount:8,xpReward:75,order:7},{type:"soundQuiz",title:"청취 마스터",description:"소리 퀴즈에서 8문제를 맞추세요",emoji:"\uD83D\uDD0A",targetCount:8,xpReward:75,order:8}]};function d(e,t){let n=l[e],r=n.filter(e=>["alphabet","phonics","words","speaking"].includes(e.type)),i=n.filter(e=>["wordMatch","memory","spelling","soundQuiz"].includes(e.type)),a=[...r].sort(()=>Math.random()-.5),s=[...i].sort(()=>Math.random()-.5);return[...a.slice(0,2),...s.slice(0,3)].map((e,n)=>({...e,id:"".concat(t,"-").concat(e.type,"-").concat(n),currentCount:0,isCompleted:!1,order:n+1}))}let c={alphabet:"/learn/alphabet",phonics:"/learn/phonics",words:"/learn/words",speaking:"/learn/speaking",wordMatch:"/games/word-match",memory:"/games/memory",spelling:"/games/spelling",soundQuiz:"/games/sound-quiz"},m={allComplete:100,perfectStreak:50},p={beginner:[{id:"bg-alphabet",category:"alphabet",title:"알파벳 학습",description:"오늘 배울 알파벳",emoji:"\uD83D\uDD24",targetCount:3,currentCount:0,unit:"개",link:"/learn/alphabet",estimatedMinutes:5},{id:"bg-phonics",category:"phonics",title:"파닉스 규칙",description:"소리 규칙 배우기",emoji:"\uD83C\uDFB5",targetCount:2,currentCount:0,unit:"개",link:"/learn/phonics",estimatedMinutes:5},{id:"bg-words",category:"words",title:"단어 학습",description:"새로운 단어 익히기",emoji:"\uD83D\uDCDA",targetCount:5,currentCount:0,unit:"개",link:"/learn/words",estimatedMinutes:5},{id:"bg-speaking",category:"speaking",title:"말하기 연습",description:"따라 말하기",emoji:"\uD83C\uDFA4",targetCount:3,currentCount:0,unit:"회",link:"/learn/speaking",estimatedMinutes:3},{id:"bg-games",category:"games",title:"복습 게임",description:"재미있게 복습하기",emoji:"\uD83C\uDFAE",targetCount:1,currentCount:0,unit:"회",link:"/games",estimatedMinutes:5}],intermediate:[{id:"im-alphabet",category:"alphabet",title:"알파벳 복습",description:"알파벳 완벽하게 익히기",emoji:"\uD83D\uDD24",targetCount:5,currentCount:0,unit:"개",link:"/learn/alphabet",estimatedMinutes:5},{id:"im-phonics",category:"phonics",title:"파닉스 규칙",description:"다양한 소리 규칙",emoji:"\uD83C\uDFB5",targetCount:3,currentCount:0,unit:"개",link:"/learn/phonics",estimatedMinutes:7},{id:"im-words",category:"words",title:"단어 학습",description:"새로운 단어 마스터",emoji:"\uD83D\uDCDA",targetCount:8,currentCount:0,unit:"개",link:"/learn/words",estimatedMinutes:8},{id:"im-speaking",category:"speaking",title:"말하기 연습",description:"정확한 발음 연습",emoji:"\uD83C\uDFA4",targetCount:5,currentCount:0,unit:"회",link:"/learn/speaking",estimatedMinutes:5},{id:"im-games",category:"games",title:"복습 게임",description:"게임으로 실력 다지기",emoji:"\uD83C\uDFAE",targetCount:2,currentCount:0,unit:"회",link:"/games",estimatedMinutes:10}],advanced:[{id:"ad-alphabet",category:"alphabet",title:"알파벳 마스터",description:"모든 알파벳 완벽 숙지",emoji:"\uD83D\uDD24",targetCount:10,currentCount:0,unit:"개",link:"/learn/alphabet",estimatedMinutes:5},{id:"ad-phonics",category:"phonics",title:"고급 파닉스",description:"복잡한 소리 규칙",emoji:"\uD83C\uDFB5",targetCount:5,currentCount:0,unit:"개",link:"/learn/phonics",estimatedMinutes:10},{id:"ad-words",category:"words",title:"단어 정복",description:"어려운 단어 도전",emoji:"\uD83D\uDCDA",targetCount:12,currentCount:0,unit:"개",link:"/learn/words",estimatedMinutes:10},{id:"ad-speaking",category:"speaking",title:"말하기 마스터",description:"완벽한 발음 구사",emoji:"\uD83C\uDFA4",targetCount:8,currentCount:0,unit:"회",link:"/learn/speaking",estimatedMinutes:8},{id:"ad-games",category:"games",title:"챌린지 게임",description:"고득점 도전",emoji:"\uD83C\uDFAE",targetCount:2,currentCount:0,unit:"회",link:"/games",estimatedMinutes:12}]},g={beginner:20,intermediate:30,advanced:40},h={beginner:{title:"\uD83C\uDF31 초급 학습자",description:"하루 15-20분 학습을 권장해요",tips:["알파벳부터 차근차근 시작해요","그림과 소리를 함께 연결해요","게임으로 재미있게 복습해요"]},intermediate:{title:"\uD83C\uDF3F 중급 학습자",description:"하루 25-30분 학습을 권장해요",tips:["파닉스 규칙을 익혀요","새로운 단어를 많이 배워요","말하기 연습으로 발음을 다듬어요"]},advanced:{title:"\uD83C\uDF33 고급 학습자",description:"하루 35-45분 학습을 권장해요",tips:["복잡한 발음 규칙에 도전해요","어려운 단어를 정복해요","게임에서 높은 점수에 도전해요"]}}},6410:function(e,t,n){let r,i,a;n.d(t,{Vv:function(){return d},Xr:function(){return c},vq:function(){return p},yL:function(){return g}});var s=n(738);n(4593);var o=n(5978),u=n(2148);n(6485);let l={apiKey:"AIzaSyCUoIzsX_Fv28uDnVNLkvGXddm_HKOCyuk",authDomain:"iswphonics.firebaseapp.com",projectId:"iswphonics",storageBucket:"iswphonics.firebasestorage.app",messagingSenderId:"528874349490",appId:"1:528874349490:web:2c41b34b4066540fd23aab",measurementId:"G-1VEHD9QYQ4"},d=new u.hJ,c="admin@iswphonics.com";function m(){return r||(r=r=0===(0,s.C6)().length?(0,s.ZF)(l):(0,s.C6)()[0]),r}function p(){return i||(i=(0,o.ad)(m())),i}function g(){return a||(a=(0,u.v0)(m())),a}},9804:function(e,t,n){n.d(t,{$9:function(){return f},Ds:function(){return y},Eq:function(){return I},Ld:function(){return C},Lj:function(){return g},MZ:function(){return D},Ry:function(){return o},Yb:function(){return s},_8:function(){return S},a:function(){return M},aA:function(){return w},c0:function(){return d},et:function(){return m},gj:function(){return A},ni:function(){return l},qH:function(){return v},qj:function(){return u}});var r=n(2148),i=n(5978),a=n(6410);async function s(e,t,n,i,s){let o=(0,a.yL)();(0,a.vq)();let u=(await (0,r.Xb)(o,e,t)).user;return await (0,r.ck)(u,{displayName:n}),await c(u,i,n,s)}async function o(e,t){let n=(0,a.yL)(),i=await (0,r.e5)(n,e,t),s=await m(i.user.uid);if(!s)throw Error("사용자 프로필을 찾을 수 없습니다.");return await p(s.uid),s}async function u(){let e=(0,a.yL)(),t=await (0,r.rh)(e,a.Vv),n=await m(t.user.uid);return n?await p(n.uid):n=await c(t.user,"student",t.user.displayName||"사용자"),n}async function l(){let e=(0,a.yL)();await (0,r.w7)(e)}async function d(e){let t=(0,a.yL)();await (0,r.LS)(t,e)}async function c(e,t,n,r){let s=(0,a.vq)(),o=e.email===a.Xr,u=o?"superAdmin":t,l=new Date,d={uid:e.uid,email:e.email||"",displayName:n,photoURL:e.photoURL||void 0,role:u,approvalStatus:"teacher"===u?"pending":"approved",schoolName:null==r?void 0:r.schoolName,classId:null==r?void 0:r.classId,teacherId:null==r?void 0:r.teacherId,studentNumber:null==r?void 0:r.studentNumber,createdAt:l,updatedAt:l,lastLoginAt:l};return await (0,i.pl)((0,i.JU)(s,"users",e.uid),{...d,createdAt:i.EK.fromDate(l),updatedAt:i.EK.fromDate(l),lastLoginAt:i.EK.fromDate(l)}),"teacher"!==t||o||await h(e.uid,e.email||"",n,(null==r?void 0:r.schoolName)||""),d}async function m(e){var t,n,r;let s=(0,a.vq)(),o=(0,i.JU)(s,"users",e),u=await (0,i.QT)(o);if(!u.exists())return null;let l=u.data();return{...l,createdAt:(null===(t=l.createdAt)||void 0===t?void 0:t.toDate())||new Date,updatedAt:(null===(n=l.updatedAt)||void 0===n?void 0:n.toDate())||new Date,lastLoginAt:(null===(r=l.lastLoginAt)||void 0===r?void 0:r.toDate())||new Date}}async function p(e){let t=(0,a.vq)();await (0,i.r7)((0,i.JU)(t,"users",e),{lastLoginAt:i.EK.now()})}async function g(e,t){let n=(0,a.vq)();await (0,i.r7)((0,i.JU)(n,"users",e),{...t,updatedAt:i.EK.now()})}async function h(e,t,n,r){let s=(0,a.vq)(),o={uid:e,email:t,displayName:n,schoolName:r,requestedAt:new Date,status:"pending"};await (0,i.pl)((0,i.JU)(s,"teacherApprovalRequests",e),{...o,requestedAt:i.EK.now()})}async function D(){let e=(0,a.vq)(),t=(0,i.IO)((0,i.hJ)(e,"teacherApprovalRequests"),(0,i.ar)("status","==","pending"),(0,i.Xo)("requestedAt","desc"));return(await (0,i.PL)(t)).docs.map(e=>{var t,n;let r=e.data();return{...r,requestedAt:(null===(t=r.requestedAt)||void 0===t?void 0:t.toDate())||new Date,reviewedAt:null===(n=r.reviewedAt)||void 0===n?void 0:n.toDate()}})}async function w(e,t){let n=(0,a.vq)(),r=(0,i.qs)(n);r.update((0,i.JU)(n,"users",e),{approvalStatus:"approved",updatedAt:i.EK.now()}),r.update((0,i.JU)(n,"teacherApprovalRequests",e),{status:"approved",reviewedBy:t,reviewedAt:i.EK.now()}),await r.commit()}async function f(e,t,n){let r=(0,a.vq)(),s=(0,i.qs)(r);s.update((0,i.JU)(r,"users",e),{approvalStatus:"rejected",updatedAt:i.EK.now()}),s.update((0,i.JU)(r,"teacherApprovalRequests",e),{status:"rejected",reviewedBy:t,reviewedAt:i.EK.now(),rejectReason:n}),await s.commit()}async function v(e,t,n,r){let s=(0,a.vq)(),o=(0,i.JU)((0,i.hJ)(s,"classes")),u=new Date,l={id:o.id,name:e,grade:r,teacherId:t,teacherName:n,studentIds:[],createdAt:u,updatedAt:u};await (0,i.pl)(o,{...l,createdAt:i.EK.fromDate(u),updatedAt:i.EK.fromDate(u)});let d=(0,i.JU)(s,"users",t),c=await (0,i.QT)(d);if(c.exists()){let e=c.data().classIds||[];await (0,i.r7)(d,{classIds:[...e,o.id],updatedAt:i.EK.now()})}return l}async function y(e){let t=(0,a.vq)(),n=(0,i.IO)((0,i.hJ)(t,"classes"),(0,i.ar)("teacherId","==",e));return(await (0,i.PL)(n)).docs.map(e=>{var t,n;let r=e.data();return{...r,createdAt:(null===(t=r.createdAt)||void 0===t?void 0:t.toDate())||new Date,updatedAt:(null===(n=r.updatedAt)||void 0===n?void 0:n.toDate())||new Date}})}async function C(){let e=(0,a.vq)();return(await (0,i.PL)((0,i.hJ)(e,"classes"))).docs.map(e=>{var t,n;let r=e.data();return{...r,createdAt:(null===(t=r.createdAt)||void 0===t?void 0:t.toDate())||new Date,updatedAt:(null===(n=r.updatedAt)||void 0===n?void 0:n.toDate())||new Date}})}async function A(e,t,n){let s=(0,a.yL)(),o=(0,a.vq)(),u=[];for(let a of n)try{let n="".concat(a.studentNumber,"@student.iswphonics.com"),l=await (0,r.Xb)(s,n,a.password);await (0,r.ck)(l.user,{displayName:a.displayName});let d=new Date,c={uid:l.user.uid,email:n,displayName:a.displayName,role:"student",approvalStatus:"approved",classId:e,teacherId:t,studentNumber:a.studentNumber,createdAt:d,updatedAt:d,lastLoginAt:d};await (0,i.pl)((0,i.JU)(o,"users",l.user.uid),{...c,createdAt:i.EK.fromDate(d),updatedAt:i.EK.fromDate(d),lastLoginAt:i.EK.fromDate(d)}),u.push(l.user.uid)}catch(e){console.error("학생 생성 실패: ".concat(a.displayName),e)}if(u.length>0){let t=(0,i.JU)(o,"classes",e),n=await (0,i.QT)(t);if(n.exists()){let e=n.data();await (0,i.r7)(t,{studentIds:[...e.studentIds||[],...u],updatedAt:i.EK.now()})}}return u}async function S(e){let t=(0,a.vq)(),n=(0,i.IO)((0,i.hJ)(t,"users"),(0,i.ar)("classId","==",e),(0,i.ar)("role","==","student"));return(await (0,i.PL)(n)).docs.map(e=>{var t,n,r;let i=e.data();return{...i,createdAt:(null===(t=i.createdAt)||void 0===t?void 0:t.toDate())||new Date,updatedAt:(null===(n=i.updatedAt)||void 0===n?void 0:n.toDate())||new Date,lastLoginAt:(null===(r=i.lastLoginAt)||void 0===r?void 0:r.toDate())||new Date}})}async function I(e){let t=(0,a.vq)(),n=(0,i.IO)((0,i.hJ)(t,"users"),(0,i.ar)("role","==",e));return(await (0,i.PL)(n)).docs.map(e=>{var t,n,r;let i=e.data();return{...i,createdAt:(null===(t=i.createdAt)||void 0===t?void 0:t.toDate())||new Date,updatedAt:(null===(n=i.updatedAt)||void 0===n?void 0:n.toDate())||new Date,lastLoginAt:(null===(r=i.lastLoginAt)||void 0===r?void 0:r.toDate())||new Date}})}async function M(e){let t=(0,a.vq)(),n=(0,i.IO)((0,i.hJ)(t,"users"),(0,i.ar)("classId","==",e),(0,i.ar)("role","==","student")),r=await (0,i.PL)(n),s=[];for(let n of r.docs){let r=n.data(),a=await (0,i.QT)((0,i.JU)(t,"userStats",n.id));if(a.exists()){var o;let t=a.data();s.push({oderId:n.id,displayName:r.displayName,classId:e,totalXp:t.totalXp||0,level:t.level||1,currentStreak:t.currentStreak||0,longestStreak:t.longestStreak||0,totalWordsLearned:t.totalWordsLearned||0,totalSessionsCompleted:t.totalSessionsCompleted||0,totalTimeSpentMinutes:t.totalTimeSpentMinutes||0,lastStudyDate:(null===(o=t.lastStudyDate)||void 0===o?void 0:o.toDate())||new Date,weeklyProgress:t.weeklyProgress||[]})}else s.push({oderId:n.id,displayName:r.displayName,classId:e,totalXp:0,level:1,currentStreak:0,longestStreak:0,totalWordsLearned:0,totalSessionsCompleted:0,totalTimeSpentMinutes:0,lastStudyDate:new Date,weeklyProgress:[]})}return s}},7509:function(e,t,n){n.d(t,{tN:function(){return w},WO:function(){return c},qm:function(){return p},LM:function(){return d}});var r=n(9625),i=n(6885),a=n(9379);let s={difficulty:"beginner",soundEnabled:!0,musicEnabled:!0,speechRate:.9,autoPlayAudio:!0,showKorean:!0,theme:"light"},o={viserId:"",totalXp:0,level:1,currentStreak:0,longestStreak:0,totalWordsLearned:0,totalSessionsCompleted:0,totalTimeSpentMinutes:0,achievementsUnlocked:[],lastStudyDate:new Date};function u(e){let t=new Date,n=new Date(e);return n.getDate()===t.getDate()&&n.getMonth()===t.getMonth()&&n.getFullYear()===t.getFullYear()}function l(e){let t=new Date;t.setDate(t.getDate()-1);let n=new Date(e);return n.getDate()===t.getDate()&&n.getMonth()===t.getMonth()&&n.getFullYear()===t.getFullYear()}let d=(0,r.Ue)()((0,i.tJ)((e,t)=>({profile:null,settings:s,stats:o,isInitialized:!1,createProfile:(t,n)=>{let r="user_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2,9));e({profile:{id:r,nickname:t,avatar:n,createdAt:new Date,lastActiveAt:new Date,settings:s},stats:{...o,viserId:r},isInitialized:!0})},updateProfile:n=>{let{profile:r}=t();r&&e({profile:{...r,...n,lastActiveAt:new Date}})},resetProfile:()=>{e({profile:null,settings:s,stats:o,isInitialized:!1})},updateSettings:n=>{let{settings:r,profile:i}=t(),a={...r,...n};e({settings:a}),i&&e({profile:{...i,settings:a}})},setDifficulty:e=>{t().updateSettings({difficulty:e})},toggleSound:()=>{let{settings:e}=t();t().updateSettings({soundEnabled:!e.soundEnabled})},toggleMusic:()=>{let{settings:e}=t();t().updateSettings({musicEnabled:!e.musicEnabled})},setSpeechRate:e=>{t().updateSettings({speechRate:Math.max(.5,Math.min(2,e))})},addXp:n=>{let{stats:r}=t(),i=r.totalXp+n,s=(0,a.X3)(i);e({stats:{...r,totalXp:i,level:s.level}})},incrementWordsLearned:function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,{stats:r}=t();e({stats:{...r,totalWordsLearned:r.totalWordsLearned+n}})},completeSession:()=>{let{stats:n}=t();e({stats:{...n,totalSessionsCompleted:n.totalSessionsCompleted+1}}),t().addXp(a.ZT.lessonComplete)},addTimeSpent:n=>{let{stats:r}=t();e({stats:{...r,totalTimeSpentMinutes:r.totalTimeSpentMinutes+n}})},updateStreak:()=>{let{stats:n}=t(),r=new Date(n.lastStudyDate);if(u(r))return;let i=1;l(r)&&(i=n.currentStreak+1);let a=Math.max(n.longestStreak,i);e({stats:{...n,currentStreak:i,longestStreak:a,lastStudyDate:new Date}})},unlockAchievement:n=>{let{stats:r}=t();r.achievementsUnlocked.includes(n)||e({stats:{...r,achievementsUnlocked:[...r.achievementsUnlocked,n]}})},getCurrentLevel:()=>{let{stats:e}=t(),n=(0,a.X3)(e.totalXp),r=n.nextLevelXp>0?n.currentXp/n.nextLevelXp*100:100;return{...n,progress:r}},checkAndUpdateStreak:()=>{let{stats:n}=t(),r=new Date(n.lastStudyDate);u(r)||l(r)||e({stats:{...n,currentStreak:0}})}}),{name:"phonics-quest-user",storage:(0,i.FL)(()=>localStorage),partialize:e=>({profile:e.profile,settings:e.settings,stats:e.stats,isInitialized:e.isInitialized})})),c=(0,r.Ue)((e,t)=>({currentSession:null,currentMode:null,currentDifficulty:"beginner",currentItemIndex:0,totalItems:0,correctAnswers:0,incorrectAnswers:0,streak:0,maxStreak:0,alphabetItems:[],phonicsItems:[],wordItems:[],currentQuestion:null,quizResults:[],isQuizMode:!1,character:{emotion:"happy",message:"오늘도 함께 공부해요!",isAnimating:!1},sessionXp:0,sessionStartTime:null,startSession:(t,n)=>{e({currentSession:{id:"session_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2,9)),userId:"",mode:t,difficulty:n,startedAt:new Date,itemsStudied:0,correctAnswers:0,totalQuestions:0,xpEarned:0},currentMode:t,currentDifficulty:n,currentItemIndex:0,correctAnswers:0,incorrectAnswers:0,streak:0,maxStreak:0,sessionXp:0,sessionStartTime:Date.now(),character:{emotion:"happy",message:"시작해볼까요?",isAnimating:!0}}),setTimeout(()=>{e(e=>({character:{...e.character,isAnimating:!1}}))},1e3)},endSession:()=>{let n=t(),r=n.sessionStartTime?Math.floor((Date.now()-n.sessionStartTime)/6e4):0,i=n.correctAnswers+n.incorrectAnswers,s=i>0?n.correctAnswers/i*100:0,o=0;100===s&&i>=5&&(o+=a.ZT.perfectLesson);let u=n.sessionXp+o;return e({currentSession:null,sessionStartTime:null,character:{emotion:s>=80?"celebrating":"encouraging",message:s>=80?"정말 잘했어요!":"다음엔 더 잘할 수 있어요!",isAnimating:!0}}),{xpEarned:u,correctRate:s,timeSpent:r}},setAlphabetItems:t=>{e({alphabetItems:t,totalItems:t.length,currentItemIndex:0})},setPhonicsItems:t=>{e({phonicsItems:t,totalItems:t.length,currentItemIndex:0})},setWordItems:t=>{e({wordItems:t,totalItems:t.length,currentItemIndex:0})},nextItem:()=>{let{currentItemIndex:n,totalItems:r}=t();n<r-1&&e({currentItemIndex:n+1})},previousItem:()=>{let{currentItemIndex:n}=t();n>0&&e({currentItemIndex:n-1})},goToItem:n=>{let{totalItems:r}=t();n>=0&&n<r&&e({currentItemIndex:n})},recordAnswer:function(n){let r,i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=t(),u=n?o.streak+1:0,l=Math.max(o.maxStreak,u),d=s;n&&(d+=a.ZT.correctAnswer),3===u&&(d+=a.ZT.streak3),5===u&&(d+=a.ZT.streak5),10===u&&(d+=a.ZT.streak10),n?u>=5?(r="excited",i=t().getRandomEncouragement("streak")):(r="happy",i=t().getRandomEncouragement("correct")):(r="encouraging",i=t().getRandomEncouragement("incorrect")),e({correctAnswers:n?o.correctAnswers+1:o.correctAnswers,incorrectAnswers:n?o.incorrectAnswers:o.incorrectAnswers+1,streak:u,maxStreak:l,sessionXp:o.sessionXp+d,character:{emotion:r,message:i,isAnimating:!0}}),setTimeout(()=>{e(e=>({character:{...e.character,isAnimating:!1}}))},1500)},startQuiz:t=>{e({isQuizMode:!0,quizResults:[],currentQuestion:t[0]||null,currentItemIndex:0,totalItems:t.length})},submitQuizAnswer:n=>{let r=t().currentQuestion;if(!r)return{questionId:"",userAnswer:n,isCorrect:!1,timeTaken:0,xpEarned:0};let i=n.toLowerCase().trim()===r.correctAnswer.toLowerCase().trim(),s=i?a.ZT.correctAnswer:0,o={questionId:r.id,userAnswer:n,isCorrect:i,timeTaken:0,xpEarned:s};return t().recordAnswer(i,s),e(e=>({quizResults:[...e.quizResults,o]})),o},endQuiz:()=>{e({isQuizMode:!1,currentQuestion:null})},setCharacterEmotion:(n,r)=>{e({character:{emotion:n,message:r||t().character.message,isAnimating:!0}}),setTimeout(()=>{e(e=>({character:{...e.character,isAnimating:!1}}))},1e3)},resetSession:()=>{e({currentSession:null,currentMode:null,currentItemIndex:0,totalItems:0,correctAnswers:0,incorrectAnswers:0,streak:0,maxStreak:0,alphabetItems:[],phonicsItems:[],wordItems:[],currentQuestion:null,quizResults:[],isQuizMode:!1,sessionXp:0,sessionStartTime:null,character:{emotion:"happy",message:"오늘도 함께 공부해요!",isAnimating:!1}})},getProgress:()=>{let{currentItemIndex:e,totalItems:n}=t();return n>0?(e+1)/n*100:0},getRandomEncouragement:e=>{let t=a._I[e];return t[Math.floor(Math.random()*t.length)]}}));function m(){let e=new Date;return"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0"))}(0,r.Ue)((e,t)=>({gameState:null,isLoading:!1,isPaused:!1,timeRemaining:0,timerInterval:null,finalScore:0,isGameOver:!1,isWinner:!1,selectedItems:[],matchedPairs:[],currentWord:null,userInput:"",hintsUsed:0,revealedLetters:[],initGame:(t,n)=>{e({isLoading:!0});let r=[],i=0,s=n.length;switch(t){case"wordMatch":r=function(e){let t=[];return e.forEach((e,n)=>{t.push({id:"word-".concat(n),content:e.word,isMatched:!1,matchId:"meaning-".concat(n)}),t.push({id:"meaning-".concat(n),content:e.meaning,isMatched:!1,matchId:"word-".concat(n)})}),t.sort(()=>Math.random()-.5)}(n.slice(0,a.th.wordMatch.rounds)),i=a.th.wordMatch.timeLimit,s=a.th.wordMatch.rounds;break;case"memory":let o=Math.min(n.length,a.th.memory.pairCount);r=function(e){let t=[];return e.forEach((e,n)=>{t.push({id:"card-a-".concat(n),content:e.word,isMatched:!1,isFlipped:!1,matchId:"card-b-".concat(n)}),t.push({id:"card-b-".concat(n),content:e.word,isMatched:!1,isFlipped:!1,matchId:"card-a-".concat(n)})}),t.sort(()=>Math.random()-.5)}(n.slice(0,o)),i=a.th.memory.timeLimit,s=o;break;case"spelling":s=Math.min(n.length,a.th.spelling.rounds);break;case"soundQuiz":s=Math.min(n.length,a.th.soundQuiz.rounds)}e({gameState:{gameType:t,currentRound:1,totalRounds:s,score:0,lives:3,timeRemaining:i>0?i:void 0,isPlaying:!1,isPaused:!1,items:r},timeRemaining:i,isLoading:!1,isGameOver:!1,isWinner:!1,selectedItems:[],matchedPairs:[],hintsUsed:0,revealedLetters:[],userInput:""})},startGame:()=>{let{gameState:n}=t();n&&(e({gameState:{...n,isPlaying:!0}}),n.timeRemaining&&t().startTimer())},pauseGame:()=>{let{gameState:n}=t();n&&(t().stopTimer(),e({gameState:{...n,isPaused:!0},isPaused:!0}))},resumeGame:()=>{let{gameState:n}=t();n&&(e({gameState:{...n,isPaused:!1},isPaused:!1}),n.timeRemaining&&t().startTimer())},endGame:()=>{let{gameState:n,matchedPairs:r,timeRemaining:i}=t();if(t().stopTimer(),!n)return{score:0,xpEarned:0,isWinner:!1};let s=n.lives>0&&(n.currentRound>n.totalRounds||r.length>=n.totalRounds),o=0;return s&&(o=a.ZT.gameWin,i&&i>30&&(o+=Math.floor(i/10)*a.th.wordMatch.bonusTimePoints)),e({isGameOver:!0,isWinner:s,finalScore:n.score,gameState:{...n,isPlaying:!1}}),{score:n.score,xpEarned:o,isWinner:s}},resetGame:()=>{t().stopTimer(),e({gameState:null,isLoading:!1,isPaused:!1,timeRemaining:0,timerInterval:null,finalScore:0,isGameOver:!1,isWinner:!1,selectedItems:[],matchedPairs:[],currentWord:null,userInput:"",hintsUsed:0,revealedLetters:[]})},selectItem:n=>{let{selectedItems:r,gameState:i}=t();if(!i||r.includes(n))return;let a=i.items.find(e=>e.id===n);a&&!a.isMatched&&(r.length<2&&e({selectedItems:[...r,n]}),1===r.length&&setTimeout(()=>{t().checkMatch()},500))},checkMatch:()=>{let{selectedItems:n,gameState:r,matchedPairs:i}=t();if(!r||2!==n.length)return!1;let[s,o]=n,u=r.items.find(e=>e.id===s),l=r.items.find(e=>e.id===o);if(!u||!l||!(u.matchId===o||l.matchId===s))return e({selectedItems:[]}),!1;{let n=r.items.map(e=>e.id===s||e.id===o?{...e,isMatched:!0}:e),u=[...i,s,o];return e({gameState:{...r,items:n,score:r.score+a.th.wordMatch.pointsPerMatch},matchedPairs:u,selectedItems:[]}),u.length>=r.items.length&&setTimeout(()=>t().endGame(),500),!0}},setCurrentWord:t=>{e({currentWord:t,userInput:"",revealedLetters:[]})},updateUserInput:t=>{e({userInput:t})},checkSpelling:()=>{let{currentWord:n,userInput:r,gameState:i,hintsUsed:s}=t();if(!n||!i)return!1;let o=r.toLowerCase().trim()===n.word.toLowerCase();if(o){let n=s>0?a.th.spelling.pointsWithHint:a.th.spelling.pointsPerCorrect;e({gameState:{...i,score:i.score+n}}),i.currentRound<i.totalRounds?t().nextRound():t().endGame()}else t().loseLife();return o},useHint:()=>{let{currentWord:n,hintsUsed:r,revealedLetters:i}=t();if(!n||r>=a.th.spelling.hintsAllowed)return null;let s=n.word,o=s.split("").map((e,t)=>t).filter(e=>!i.includes(e));if(0===o.length)return null;let u=o[Math.floor(Math.random()*o.length)];return e({hintsUsed:r+1,revealedLetters:[...i,u]}),s[u]},flipCard:n=>{let{gameState:r,selectedItems:i}=t();if(!r||i.length>=2)return;let s=r.items.find(e=>e.id===n);if(!s||s.isMatched||s.isFlipped)return;let o=r.items.map(e=>e.id===n?{...e,isFlipped:!0}:e);e({gameState:{...r,items:o},selectedItems:[...i,n]}),1===i.length&&setTimeout(()=>{var n,r;let i=t(),[s,o]=i.selectedItems,u=null===(n=i.gameState)||void 0===n?void 0:n.items.find(e=>e.id===s),l=null===(r=i.gameState)||void 0===r?void 0:r.items.find(e=>e.id===o);if(u&&l&&u.matchId===o){let n=i.gameState.items.map(e=>e.id===s||e.id===o?{...e,isMatched:!0}:e);e({gameState:{...i.gameState,items:n,score:i.gameState.score+a.th.memory.pointsPerPair},matchedPairs:[...i.matchedPairs,s,o],selectedItems:[]}),n.every(e=>e.isMatched)&&setTimeout(()=>t().endGame(),500)}else{let t=i.gameState.items.map(e=>e.id===s||e.id===o?{...e,isFlipped:!1}:e);e({gameState:{...i.gameState,items:t},selectedItems:[]})}},1e3)},startTimer:()=>{let{timerInterval:n}=t();n||e({timerInterval:setInterval(()=>{t().decrementTime()},1e3)})},stopTimer:()=>{let{timerInterval:n}=t();n&&(clearInterval(n),e({timerInterval:null}))},decrementTime:()=>{let{timeRemaining:n,gameState:r}=t();if(n<=0){t().endGame();return}e({timeRemaining:n-1,gameState:r?{...r,timeRemaining:n-1}:null})},addScore:n=>{let{gameState:r}=t();r&&e({gameState:{...r,score:r.score+n}})},loseLife:()=>{let{gameState:n}=t();if(!n)return;let r=n.lives-1;r<=0?t().endGame():e({gameState:{...n,lives:r}})},nextRound:()=>{let{gameState:n}=t();n&&e({gameState:{...n,currentRound:n.currentRound+1},userInput:"",revealedLetters:[]})}}));let p=(0,r.Ue)()((0,i.tJ)((e,t)=>({dailyMissions:null,missionStreak:0,lastCompletedDate:null,initializeDailyMissions:n=>{let r=m(),{dailyMissions:i,lastCompletedDate:s}=t();if(i&&i.date===r)return;let o=0;if(s){let e=new Date;e.setDate(e.getDate()-1),s==="".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0"))&&(o=t().missionStreak+1)}let u=(0,a.YO)(n,r);e({dailyMissions:{date:r,missions:u,totalMissions:u.length,completedMissions:0,bonusXpClaimed:!1},missionStreak:o})},updateMissionProgress:(n,r)=>{let{dailyMissions:i}=t();if(!i)return;let a=m();if(i.date!==a)return;let s=i.missions.map(e=>{if(e.type===n&&!e.isCompleted){let t=e.currentCount+r,n=t>=e.targetCount;return{...e,currentCount:Math.min(t,e.targetCount),isCompleted:n}}return e}),o=s.filter(e=>e.isCompleted).length;e({dailyMissions:{...i,missions:s,completedMissions:o}})},completeMission:n=>{let{dailyMissions:r}=t();if(!r)return{xpEarned:0,allComplete:!1};let i=r.missions.find(e=>e.id===n);if(!i||i.isCompleted)return{xpEarned:0,allComplete:!1};let a=r.missions.map(e=>e.id===n?{...e,isCompleted:!0,currentCount:e.targetCount}:e),s=a.filter(e=>e.isCompleted).length,o=s===r.totalMissions;return e({dailyMissions:{...r,missions:a,completedMissions:s}}),o&&e({lastCompletedDate:r.date,missionStreak:t().missionStreak+1}),{xpEarned:i.xpReward,allComplete:o}},claimDailyBonus:()=>{let{dailyMissions:n,missionStreak:r}=t();if(!n||n.bonusXpClaimed||n.completedMissions!==n.totalMissions)return 0;let i=a.YD.allComplete;return r>=3&&(i+=a.YD.perfectStreak),e({dailyMissions:{...n,bonusXpClaimed:!0}}),i},resetMissions:()=>{e({dailyMissions:null,missionStreak:0,lastCompletedDate:null})},getMissionByType:e=>{let{dailyMissions:n}=t();if(n)return n.missions.find(t=>t.type===e)},getTodayProgress:()=>{let{dailyMissions:e}=t();return e?{completed:e.completedMissions,total:e.totalMissions,percentage:e.completedMissions/e.totalMissions*100}:{completed:0,total:0,percentage:0}},checkAndRefreshMissions:e=>{let{dailyMissions:n}=t(),r=m();n&&n.date===r||t().initializeDailyMissions(e)}}),{name:"phonics-quest-missions",storage:(0,i.FL)(()=>localStorage),partialize:e=>({dailyMissions:e.dailyMissions,missionStreak:e.missionStreak,lastCompletedDate:e.lastCompletedDate})}));var g=n(2148),h=n(6410),D=n(9804);let w=(0,r.Ue)()((0,i.tJ)((e,t)=>({user:null,firebaseUser:null,isLoading:!0,isInitialized:!1,error:null,get isAuthenticated(){return!!t().user},get isSuperAdmin(){var n;return(null===(n=t().user)||void 0===n?void 0:n.role)==="superAdmin"},get isTeacher(){var r;return(null===(r=t().user)||void 0===r?void 0:r.role)==="teacher"},get isStudent(){var i;return(null===(i=t().user)||void 0===i?void 0:i.role)==="student"},get isApproved(){var a;return(null===(a=t().user)||void 0===a?void 0:a.approvalStatus)==="approved"},initialize:async()=>{let t=(0,h.yL)();return new Promise(n=>{(0,g.Aj)(t,async t=>{if(t)try{let n=await (0,D.et)(t.uid);e({firebaseUser:t,user:n,isLoading:!1,isInitialized:!0})}catch(t){console.error("사용자 프로필 로드 실패:",t),e({firebaseUser:null,user:null,isLoading:!1,isInitialized:!0,error:"사용자 정보를 불러오는데 실패했습니다."})}else e({firebaseUser:null,user:null,isLoading:!1,isInitialized:!0});n()})})},signUp:async(t,n,r,i,a)=>{e({isLoading:!0,error:null});try{let s=await (0,D.Yb)(t,n,r,i,a);e({user:s,isLoading:!1})}catch(n){let t="회원가입에 실패했습니다.";throw"auth/email-already-in-use"===n.code?t="이미 사용 중인 이메일입니다.":"auth/weak-password"===n.code?t="비밀번호가 너무 약합니다. 6자 이상 입력해주세요.":"auth/invalid-email"===n.code&&(t="유효하지 않은 이메일 형식입니다."),e({isLoading:!1,error:t}),Error(t)}},signIn:async(t,n)=>{e({isLoading:!0,error:null});try{let r=await (0,D.Ry)(t,n);e({user:r,isLoading:!1})}catch(n){let t="로그인에 실패했습니다.";throw"auth/user-not-found"===n.code||"auth/wrong-password"===n.code?t="이메일 또는 비밀번호가 올바르지 않습니다.":"auth/too-many-requests"===n.code&&(t="로그인 시도가 너무 많습니다. 잠시 후 다시 시도해주세요."),e({isLoading:!1,error:t}),Error(t)}},signInGoogle:async()=>{e({isLoading:!0,error:null});try{let t=await (0,D.qj)();e({user:t,isLoading:!1})}catch(n){let t="Google 로그인에 실패했습니다.";throw"auth/popup-closed-by-user"===n.code&&(t="로그인이 취소되었습니다."),e({isLoading:!1,error:t}),Error(t)}},signOut:async()=>{e({isLoading:!0,error:null});try{await (0,D.ni)(),e({user:null,firebaseUser:null,isLoading:!1})}catch(t){throw e({isLoading:!1,error:"로그아웃에 실패했습니다."}),t}},sendPasswordReset:async t=>{e({isLoading:!0,error:null});try{await (0,D.c0)(t),e({isLoading:!1})}catch(n){let t="비밀번호 재설정 이메일 발송에 실패했습니다.";throw"auth/user-not-found"===n.code&&(t="해당 이메일로 등록된 계정이 없습니다."),e({isLoading:!1,error:t}),Error(t)}},updateProfile:async n=>{let{user:r}=t();if(r){e({isLoading:!0,error:null});try{await (0,D.Lj)(r.uid,n),e({user:{...r,...n},isLoading:!1})}catch(t){throw e({isLoading:!1,error:"프로필 업데이트에 실패했습니다."}),t}}},clearError:()=>{e({error:null})},refreshUser:async()=>{let{user:n}=t();if(n)try{let t=await (0,D.et)(n.uid);t&&e({user:t})}catch(e){console.error("사용자 정보 새로고침 실패:",e)}}}),{name:"phonics-quest-auth",storage:(0,i.FL)(()=>localStorage),partialize:e=>({})}))}}]);