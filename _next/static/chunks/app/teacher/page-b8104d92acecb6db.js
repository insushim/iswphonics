(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[941],{8237:function(e,s,t){Promise.resolve().then(t.bind(t,7169))},1769:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]])},407:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},1723:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},6399:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]])},7692:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},7168:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},6595:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])},5805:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},9376:function(e,s,t){"use strict";var a=t(5475);t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}})},7169:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return k}});var a=t(7437),l=t(2265),n=t(9376),c=t(429),i=t(5095),r=t(7168),x=t(7692),d=t(407),m=t(9763);let o=(0,m.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var h=t(5805);let u=(0,m.Z)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var p=t(6595),y=t(1769),g=t(1723),j=t(6399),f=t(7509),N=t(1592),b=t(9804),v=t(3448);function k(){let e=(0,n.useRouter)(),{user:s,signOut:t,isInitialized:m,initialize:k}=(0,f.tN)(),[w,Z]=(0,l.useState)("classes"),[C,z]=(0,l.useState)([]),[D,S]=(0,l.useState)(null),[M,E]=(0,l.useState)([]),[L,F]=(0,l.useState)([]),[I,P]=(0,l.useState)(!0),[H,_]=(0,l.useState)(!1),[q,R]=(0,l.useState)(!1),[A,B]=(0,l.useState)(""),[X,O]=(0,l.useState)(""),[T,U]=(0,l.useState)("");(0,l.useEffect)(()=>{m||k()},[m,k]),(0,l.useEffect)(()=>{m&&(s?"teacher"!==s.role?e.push("/"):"approved"!==s.approvalStatus&&e.push("/auth/pending"):e.push("/auth/login"))},[s,m,e]),(0,l.useEffect)(()=>{(null==s?void 0:s.role)==="teacher"&&"approved"===s.approvalStatus&&W()},[s]);let W=async()=>{if(s){P(!0);try{let e=await (0,b.Ds)(s.uid);z(e)}catch(e){console.error("학급 로드 실패:",e)}finally{P(!1)}}},V=async e=>{try{let s=await (0,b._8)(e);E(s)}catch(e){console.error("학생 로드 실패:",e)}},G=async e=>{try{let s=await (0,b.a)(e);F(s)}catch(e){console.error("학습 통계 로드 실패:",e)}},J=async e=>{S(e),Z("students"),await Promise.all([V(e.id),G(e.id)])},K=async()=>{if(s&&A.trim())try{await (0,b.qH)(A,s.uid,s.displayName,X),B(""),O(""),_(!1),await W()}catch(e){console.error("학급 생성 실패:",e)}},Q=async()=>{if(!s||!D||!T.trim())return;let e=T.split("\n").filter(e=>e.trim()).map(e=>{let s=e.split(",").map(e=>e.trim());return{displayName:s[0]||"",studentNumber:s[1]||"",password:s[2]||"phonics123"}}).filter(e=>e.displayName&&e.studentNumber);if(0!==e.length)try{await (0,b.gj)(D.id,s.uid,e),U(""),R(!1),await V(D.id),await G(D.id)}catch(e){console.error("학생 일괄 생성 실패:",e)}},Y=async()=>{await t(),e.push("/")};return m&&s&&"teacher"===s.role&&"approved"===s.approvalStatus?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm sticky top-0 z-40",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-xl",children:"\uD83D\uDC68‍\uD83C\uDFEB"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"font-bold text-gray-800",children:"선생님 대시보드"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[s.displayName," (",s.schoolName,")"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(N.zx,{variant:"outline",size:"sm",onClick:()=>{S(null),Z("classes"),W()},leftIcon:(0,a.jsx)(r.Z,{size:16}),children:"새로고침"}),(0,a.jsx)(N.zx,{variant:"ghost",size:"sm",onClick:Y,leftIcon:(0,a.jsx)(x.Z,{size:16}),children:"로그아웃"})]})]})})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-6",children:[D&&(0,a.jsxs)("button",{onClick:()=>{S(null),Z("classes")},className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 mb-4",children:[(0,a.jsx)(d.Z,{size:20,className:"rotate-180"}),(0,a.jsx)("span",{children:"학급 목록으로"})]}),!D&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"내 학급"}),(0,a.jsx)(N.zx,{onClick:()=>_(!0),leftIcon:(0,a.jsx)(o,{size:18}),children:"학급 만들기"})]}),I?(0,a.jsx)("div",{className:"flex justify-center py-12",children:(0,a.jsx)(r.Z,{size:32,className:"animate-spin text-green-500"})}):0===C.length?(0,a.jsxs)(N.Zb,{className:"p-12 text-center",children:[(0,a.jsx)("span",{className:"text-6xl mb-4 block",children:"\uD83C\uDFEB"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"학급이 없습니다"}),(0,a.jsx)("p",{className:"text-gray-500 mb-6",children:"학급을 만들어 학생들을 관리하세요!"}),(0,a.jsx)(N.zx,{onClick:()=>_(!0),leftIcon:(0,a.jsx)(o,{size:18}),children:"첫 학급 만들기"})]}):(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:C.map(e=>(0,a.jsx)(c.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>J(e),className:"w-full text-left",children:(0,a.jsx)(N.Zb,{className:"p-6 hover:shadow-lg transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"w-14 h-14 rounded-full bg-green-100 flex items-center justify-center text-2xl",children:"\uD83C\uDFEB"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-bold text-gray-800 text-lg",children:e.name}),e.grade&&(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.grade}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)(h.Z,{size:16,className:"text-gray-400"}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["학생 ",e.studentIds.length,"명"]})]})]}),(0,a.jsx)(d.Z,{size:20,className:"text-gray-400"})]})})},e.id))})]}),D&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N.Zb,{className:"p-6 mb-6 bg-gradient-to-r from-green-50 to-emerald-50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 rounded-full bg-green-100 flex items-center justify-center text-3xl",children:"\uD83C\uDFEB"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:D.name}),(0,a.jsxs)("p",{className:"text-gray-600",children:["학생 ",M.length,"명"]})]})]}),(0,a.jsx)(N.zx,{onClick:()=>R(!0),leftIcon:(0,a.jsx)(u,{size:18}),children:"학생 추가"})]})}),(0,a.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,a.jsx)("button",{onClick:()=>Z("students"),className:(0,v.cn)("px-4 py-2 rounded-lg font-medium transition-all","students"===w?"bg-green-600 text-white":"bg-white text-gray-600 hover:bg-gray-100"),children:"학생 목록"}),(0,a.jsx)("button",{onClick:()=>Z("stats"),className:(0,v.cn)("px-4 py-2 rounded-lg font-medium transition-all","stats"===w?"bg-green-600 text-white":"bg-white text-gray-600 hover:bg-gray-100"),children:"학습 현황"})]}),"students"===w&&(0,a.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:0===M.length?(0,a.jsxs)("div",{className:"p-12 text-center",children:[(0,a.jsx)("span",{className:"text-6xl mb-4 block",children:"\uD83D\uDCDA"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"학생이 없습니다"}),(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"학생을 추가해주세요!"}),(0,a.jsx)(N.zx,{onClick:()=>R(!0),leftIcon:(0,a.jsx)(u,{size:18}),children:"학생 추가"})]}):(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"번호"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"이름"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"학번"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"마지막 접속"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-100",children:M.map((e,s)=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:s+1}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-amber-100 flex items-center justify-center text-sm",children:"\uD83D\uDCDA"}),(0,a.jsx)("span",{className:"font-medium",children:e.displayName})]})}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.studentNumber}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-500",children:new Date(e.lastLoginAt).toLocaleDateString()})]},e.uid))})]})}),"stats"===w&&(0,a.jsx)("div",{className:"space-y-4",children:0===L.length?(0,a.jsxs)(N.Zb,{className:"p-12 text-center",children:[(0,a.jsx)("span",{className:"text-6xl mb-4 block",children:"\uD83D\uDCCA"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"학습 데이터가 없습니다"}),(0,a.jsx)("p",{className:"text-gray-500",children:"학생들이 학습을 시작하면 여기에 표시됩니다."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsx)(N.Zb,{className:"p-4 bg-amber-50",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(p.Z,{className:"text-amber-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:Math.round(L.reduce((e,s)=>e+s.totalXp,0)/L.length)}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"평균 XP"})]})]})}),(0,a.jsx)(N.Zb,{className:"p-4 bg-green-50",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(y.Z,{className:"text-green-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:Math.round(L.reduce((e,s)=>e+s.totalWordsLearned,0)/L.length)}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"평균 단어"})]})]})}),(0,a.jsx)(N.Zb,{className:"p-4 bg-blue-50",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(g.Z,{className:"text-blue-500"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-800",children:[Math.round(L.reduce((e,s)=>e+s.totalTimeSpentMinutes,0)/L.length),"분"]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"평균 학습시간"})]})]})}),(0,a.jsx)(N.Zb,{className:"p-4 bg-purple-50",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(j.Z,{className:"text-purple-500"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-800",children:[Math.max(...L.map(e=>e.currentStreak)),"일"]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"최고 스트릭"})]})]})})]}),(0,a.jsx)(N.Zb,{className:"overflow-hidden",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"학생"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"레벨"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"XP"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"단어"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"스트릭"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"마지막 학습"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-100",children:L.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-3 font-medium",children:e.displayName}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsxs)("span",{className:"px-2 py-1 bg-purple-100 text-purple-600 rounded-full text-sm",children:["Lv.",e.level]})}),(0,a.jsx)("td",{className:"px-4 py-3 text-amber-600 font-medium",children:e.totalXp}),(0,a.jsxs)("td",{className:"px-4 py-3",children:[e.totalWordsLearned,"개"]}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(j.Z,{size:14,className:"text-orange-500"}),(0,a.jsxs)("span",{children:[e.currentStreak,"일"]})]})}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-500",children:new Date(e.lastStudyDate).toLocaleDateString()})]},e.oderId))})]})})]})})]}),(0,a.jsx)(i.M,{children:H&&(0,a.jsx)(c.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>_(!1),children:(0,a.jsxs)(c.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-2xl p-6 w-full max-w-md",onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"학급 만들기"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"학급명 *"}),(0,a.jsx)("input",{type:"text",value:A,onChange:e=>B(e.target.value),placeholder:"예: 1학년 2반",className:"w-full px-4 py-2 rounded-lg border border-gray-200 focus:border-green-400 focus:ring-2 focus:ring-green-100 outline-none"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"학년 (선택)"}),(0,a.jsx)("input",{type:"text",value:X,onChange:e=>O(e.target.value),placeholder:"예: 1학년",className:"w-full px-4 py-2 rounded-lg border border-gray-200 focus:border-green-400 focus:ring-2 focus:ring-green-100 outline-none"})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,a.jsx)(N.zx,{variant:"outline",className:"flex-1",onClick:()=>_(!1),children:"취소"}),(0,a.jsx)(N.zx,{className:"flex-1",onClick:K,disabled:!A.trim(),children:"만들기"})]})]})})}),(0,a.jsx)(i.M,{children:q&&(0,a.jsx)(c.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>R(!1),children:(0,a.jsxs)(c.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-2xl p-6 w-full max-w-lg",onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"학생 일괄 추가"}),(0,a.jsxs)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg text-sm text-blue-700",children:[(0,a.jsx)("p",{className:"font-medium mb-1",children:"입력 형식"}),(0,a.jsx)("p",{children:"한 줄에 하나씩: 이름,학번,비밀번호"}),(0,a.jsx)("p",{className:"text-xs mt-1",children:"비밀번호를 생략하면 기본값(phonics123)이 사용됩니다."})]}),(0,a.jsx)("textarea",{value:T,onChange:e=>U(e.target.value),placeholder:"홍길동,20240101,password123\n김철수,20240102\n이영희,20240103,mypass456",rows:8,className:"w-full px-4 py-2 rounded-lg border border-gray-200 focus:border-green-400 focus:ring-2 focus:ring-green-100 outline-none font-mono text-sm"}),(0,a.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,a.jsx)(N.zx,{variant:"outline",className:"flex-1",onClick:()=>R(!1),children:"취소"}),(0,a.jsx)(N.zx,{className:"flex-1",onClick:Q,disabled:!T.trim(),children:"추가하기"})]})]})})})]})]}):(0,a.jsx)(N.SX,{})}}},function(e){e.O(0,[609,324,112,385,592,509,971,117,744],function(){return e(e.s=8237)}),_N_E=e.O()}]);