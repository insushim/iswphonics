(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{6381:function(e,s,t){Promise.resolve().then(t.bind(t,578))},5900:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]])},7692:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},7168:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},6096:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("School",[["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M14 22v-4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v4",key:"cpkuc4"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]])},5805:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},9376:function(e,s,t){"use strict";var a=t(5475);t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}})},578:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return b}});var a=t(7437),l=t(2265),i=t(9376),r=t(5095),c=t(429),n=t(7168),d=t(7692),x=t(9763);let o=(0,x.Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);var u=t(5900),m=t(5805),h=t(6096);let p=(0,x.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var y=t(401),g=t(2489),j=t(1),f=t(1592),v=t(9804),N=t(3448);function b(){let e=(0,i.useRouter)(),{user:s,signOut:t,isInitialized:x,initialize:y}=(0,j.tN)(),[g,N]=(0,l.useState)("pending"),[b,E]=(0,l.useState)([]),[M,S]=(0,l.useState)([]),[L,q]=(0,l.useState)([]),[A,I]=(0,l.useState)([]),[R,_]=(0,l.useState)(!0),[B,F]=(0,l.useState)("");(0,l.useEffect)(()=>{x||y()},[x,y]),(0,l.useEffect)(()=>{x&&(!s||"superAdmin"!==s.role)&&e.push("/")},[s,x,e]),(0,l.useEffect)(()=>{(null==s?void 0:s.role)==="superAdmin"&&H()},[s]);let H=async()=>{_(!0);try{let[e,s,t,a]=await Promise.all([(0,v.MZ)(),(0,v.Eq)("teacher"),(0,v.Eq)("student"),(0,v.Ld)()]);E(e),S(s),q(t),I(a)}catch(e){console.error("데이터 로드 실패:",e)}finally{_(!1)}},O=async e=>{if(s)try{await (0,v.aA)(e,s.uid),await H()}catch(e){console.error("승인 실패:",e)}},P=async e=>{if(!s)return;let t=prompt("거부 사유를 입력하세요:");if(null!==t)try{await (0,v.$9)(e,s.uid,t),await H()}catch(e){console.error("거부 실패:",e)}},U=async()=>{await t(),e.push("/")};if(!x||!s||"superAdmin"!==s.role)return(0,a.jsx)(f.SX,{});let G=M.filter(e=>{var s;return e.displayName.toLowerCase().includes(B.toLowerCase())||e.email.toLowerCase().includes(B.toLowerCase())||(null===(s=e.schoolName)||void 0===s?void 0:s.toLowerCase().includes(B.toLowerCase()))}),V=L.filter(e=>e.displayName.toLowerCase().includes(B.toLowerCase())||e.email.toLowerCase().includes(B.toLowerCase()));return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm sticky top-0 z-40",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-xl",children:"\uD83D\uDC51"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"font-bold text-gray-800",children:"관리자 대시보드"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:s.email})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(f.zx,{variant:"outline",size:"sm",onClick:H,leftIcon:(0,a.jsx)(n.Z,{size:16}),children:"새로고침"}),(0,a.jsx)(f.zx,{variant:"ghost",size:"sm",onClick:U,leftIcon:(0,a.jsx)(d.Z,{size:16}),children:"로그아웃"})]})]})})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,a.jsx)(w,{icon:(0,a.jsx)(o,{className:"text-amber-500"}),label:"승인 대기",value:b.length,color:"amber"}),(0,a.jsx)(w,{icon:(0,a.jsx)(u.Z,{className:"text-green-500"}),label:"선생님",value:M.filter(e=>"approved"===e.approvalStatus).length,color:"green"}),(0,a.jsx)(w,{icon:(0,a.jsx)(m.Z,{className:"text-blue-500"}),label:"학생",value:L.length,color:"blue"}),(0,a.jsx)(w,{icon:(0,a.jsx)(h.Z,{className:"text-purple-500"}),label:"학급",value:A.length,color:"purple"})]}),(0,a.jsxs)("div",{className:"flex gap-2 mb-6 overflow-x-auto pb-2",children:[(0,a.jsx)(k,{active:"pending"===g,onClick:()=>N("pending"),badge:b.length>0?b.length:void 0,children:"승인 대기"}),(0,a.jsx)(k,{active:"teachers"===g,onClick:()=>N("teachers"),children:"선생님 관리"}),(0,a.jsx)(k,{active:"students"===g,onClick:()=>N("students"),children:"학생 관리"}),(0,a.jsx)(k,{active:"classes"===g,onClick:()=>N("classes"),children:"학급 관리"})]}),("teachers"===g||"students"===g)&&(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(p,{size:20,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,a.jsx)("input",{type:"text",value:B,onChange:e=>F(e.target.value),placeholder:"이름, 이메일, 학교명으로 검색...",className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 focus:border-purple-400 focus:ring-2 focus:ring-purple-100 outline-none"})]})}),R?(0,a.jsx)("div",{className:"flex justify-center py-12",children:(0,a.jsx)(n.Z,{size:32,className:"animate-spin text-purple-500"})}):(0,a.jsxs)(r.M,{mode:"wait",children:["pending"===g&&(0,a.jsx)(c.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:0===b.length?(0,a.jsx)(C,{icon:"✅",title:"대기 중인 요청이 없습니다",description:"모든 선생님 가입 요청이 처리되었습니다."}):(0,a.jsx)("div",{className:"space-y-3",children:b.map(e=>(0,a.jsx)(D,{request:e,onApprove:()=>O(e.uid),onReject:()=>P(e.uid)},e.uid))})},"pending"),"teachers"===g&&(0,a.jsx)(c.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:0===G.length?(0,a.jsx)(C,{icon:"\uD83D\uDC68‍\uD83C\uDFEB",title:"선생님이 없습니다",description:"아직 가입한 선생님이 없습니다."}):(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:G.map(e=>(0,a.jsx)(Z,{teacher:e,classes:A},e.uid))})},"teachers"),"students"===g&&(0,a.jsx)(c.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:0===V.length?(0,a.jsx)(C,{icon:"\uD83D\uDCDA",title:"학생이 없습니다",description:"아직 가입한 학생이 없습니다."}):(0,a.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"이름"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"이메일"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"학급"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"가입일"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-100",children:V.map(e=>{let s=A.find(s=>s.id===e.classId);return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-amber-100 flex items-center justify-center text-sm",children:"\uD83D\uDCDA"}),(0,a.jsx)("span",{className:"font-medium",children:e.displayName})]})}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.email}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:s?s.name:"-"}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()})]},e.uid)})})]})})},"students"),"classes"===g&&(0,a.jsx)(c.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:0===A.length?(0,a.jsx)(C,{icon:"\uD83C\uDFEB",title:"학급이 없습니다",description:"아직 생성된 학급이 없습니다."}):(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:A.map(e=>(0,a.jsx)(z,{classInfo:e},e.id))})},"classes")]})]})]})}function w(e){let{icon:s,label:t,value:l,color:i}=e;return(0,a.jsx)(f.Zb,{className:(0,N.cn)("p-4",{amber:"bg-amber-50",green:"bg-green-50",blue:"bg-blue-50",purple:"bg-purple-50"}[i]),children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[s,(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:l}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:t})]})]})})}function k(e){let{children:s,active:t,onClick:l,badge:i}=e;return(0,a.jsxs)("button",{onClick:l,className:(0,N.cn)("px-4 py-2 rounded-lg font-medium whitespace-nowrap transition-all relative",t?"bg-purple-600 text-white":"bg-white text-gray-600 hover:bg-gray-100"),children:[s,void 0!==i&&i>0&&(0,a.jsx)("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:i})]})}function C(e){let{icon:s,title:t,description:l}=e;return(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("span",{className:"text-6xl mb-4 block",children:s}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:t}),(0,a.jsx)("p",{className:"text-gray-500",children:l})]})}function D(e){let{request:s,onApprove:t,onReject:l}=e;return(0,a.jsxs)(f.Zb,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center text-2xl",children:"\uD83D\uDC68‍\uD83C\uDFEB"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-gray-800",children:s.displayName}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:s.email}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:s.schoolName})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(f.zx,{size:"sm",onClick:t,leftIcon:(0,a.jsx)(y.Z,{size:16}),className:"bg-green-500 hover:bg-green-600",children:"승인"}),(0,a.jsx)(f.zx,{size:"sm",variant:"outline",onClick:l,leftIcon:(0,a.jsx)(g.Z,{size:16}),className:"text-red-500 border-red-200 hover:bg-red-50",children:"거부"})]})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-400 mt-3",children:["요청일: ",new Date(s.requestedAt).toLocaleString()]})]})}function Z(e){let{teacher:s,classes:t}=e,l=t.filter(e=>e.teacherId===s.uid);return(0,a.jsx)(f.Zb,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center text-2xl",children:"\uD83D\uDC68‍\uD83C\uDFEB"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"font-bold text-gray-800",children:s.displayName}),(0,a.jsx)("span",{className:(0,N.cn)("text-xs px-2 py-0.5 rounded-full","approved"===s.approvalStatus?"bg-green-100 text-green-600":"pending"===s.approvalStatus?"bg-amber-100 text-amber-600":"bg-red-100 text-red-600"),children:"approved"===s.approvalStatus?"승인됨":"pending"===s.approvalStatus?"대기중":"거부됨"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:s.email}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:s.schoolName}),l.length>0&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"담당 학급:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:l.map(e=>(0,a.jsx)("span",{className:"text-xs bg-blue-100 text-blue-600 px-2 py-0.5 rounded",children:e.name},e.id))})]})]})]})})}function z(e){let{classInfo:s}=e;return(0,a.jsx)(f.Zb,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center text-2xl",children:"\uD83C\uDFEB"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-bold text-gray-800",children:s.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["담당: ",s.teacherName]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)(m.Z,{size:14,className:"text-gray-400"}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["학생 ",s.studentIds.length,"명"]})]})]})]})})}}},function(e){e.O(0,[609,324,577,974,592,91,1,971,117,744],function(){return e(e.s=6381)}),_N_E=e.O()}]);